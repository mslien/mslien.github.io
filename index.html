
<!DOCTYPE html>
<html>

<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <meta http-equiv="expires" content="timestamp" />

  <script src="./web/jquery/jquery.min.js"></script>
  <script src="./web/jquery/jquery-ui.min.js"></script>
  <link rel="stylesheet" href="./web/jquery/jquery-ui.css">

  <style> 
  .visitor {
            position: fixed;
            bottom: 0;
            right: 0;
            padding: 0px;
            
            color: #808080;
            font-size: 16px;
            border-radius: 5px 0 0 0;
        } 
    body::-webkit-scrollbar { display: none; }
    body { -ms-overflow-style: none; scrollbar-width: none; overflow:hidden; padding: 0; margin: 0; }
    input[type="text"]{position:relative;display:block;margin:0 auto}
    div.relative { padding: 0; color:blue; text-decoration: underline overline dotted red; position: absolute; right:10%; bottom:5%; z-index:1; font-size:200%; } 
    .myTextBox { border: hidden; outline:none; }   
    @media (max-aspect-ratio: 1){
      .container-info, .container-main { width: 100%; height: 4vh; display: flex; justify-content: center; align-items: center; overflow:hidden; }
    }
    @media (min-aspect-ratio: 1) {
      .container-info { float: left; justify-content: center; right: 0; top: 0; height: 12vh; width: 50%; overflow:hidden; }
      .container-main { float: right; justify-content: center; left: 0; top: 0; height: 12vh; width: 50%; overflow:hidden; }
    }
    html, body, object#iframeL { background: white; display: block; margin: 0; height: 100vh; width: 100%; border: none; overflow: hidden; }
  </style>

  <script>
  // Ngăn lỗi context ngoài
  window.addEventListener('error', function (e) {
    if (e.message.includes("Cannot read properties of null (reading 'context')")) {
      e.preventDefault();
    }
  }, true);
  </script>
</head> 

<body>
  <span><button id="reloadBtn" onclick="reloadPage();" style="justify-content: center;align-items: center; top:50%; left:50%;position:absolute;font-size:200%;">HI</button></span>
  <br>
  <div class="container-main" id="clock" style="font-size:150%;text-align: center; display:none;"></div>
  <div class="container-info"><input id="textm" class="myTextBox" type="text" style="font-size:150%;width:50vw;line-height:125%;text-align:center;margin:auto;display:none;" maxlength="4" size="2" placeholder="&#9990;&nbsp; 0377414995" /></div> 
  <div id="demo" class="relative" title="Bài tập"></div> 
  <object id="iframeL" data="" type="text/html" height="100vh" width="100%" align="center" allow="" style="justify-content: center; padding:5%"></object>

<script>
const urlA="https://script.google.com/macros/s/AKfycbyCGCGMlVgn9St8o_pjvrcuaWakCOFWYbmnDVUyncnb2dEk-zY9QCrM1u5SbdZAOrm7/exec";
const urlB="https://script.google.com/macros/s/AKfycbxWO2DBJqDennWZKibVULZUKLxI3rxEJdjTB5T076aN3-q3nRh7-fYDiY2pPX9Gk9g/exec";
const urlC="https://script.google.com/macros/s/AKfycby4E8OCz76fPXPknjoGsibJsNhN2M_ofezrgpecJkIxgu4tIBBhMZ3qET6MtWxZbx9t/exec";
const urlD="https://script.google.com/macros/s/AKfycbxXbJ52tGMyJlXf8As5JekaqNsIdojgPAVbbMHORr2NO-kZH3NA8AQMMCLhNAeBJd3O/exec";
const urlE="https://script.google.com/macros/s/AKfycbyyKiKgH1xw2JgZEqYxAZDpIqQmr6gCTuMgTZqfhGFA0M4l_7GOl2ljtFGgqpInVAem/exec";
    urlF="https://script.google.com/macros/s/AKfycbwM1YbVN-4WCs2MJa4X8sTIqlYQrPnY5J_I8hZn_Sc34rPpoasirY7frdBelkDyhgV2/exec"
function reloadPage() {
  const reloadButton = document.getElementById("reloadBtn");
  reloadButton.style.display = "none";
  sessionStorage.setItem("buttonHidden", "true");
  const url = new URL(window.location.href);
  url.searchParams.set('reloadTime', Date.now().toString());
  window.history.replaceState(null, '', url.origin + url.pathname);
  document.getElementById("iframeL").style.display = "block";
  document.getElementById("clock").style.display = "block";
  document.getElementById("textm").style.display = "block";
}

window.onload = function() {
  const reloadButton = document.getElementById("reloadBtn");
  const buttonHidden = sessionStorage.getItem("buttonHidden");
  if (buttonHidden === "true") {
    reloadButton.style.display = "none";
    document.getElementById("iframeL").style.display = "flex";
    document.getElementById("clock").style.display = "flex";
    document.getElementById("textm").style.display = "flex";
  } else {
    reloadButton.style.display = "block";
    document.getElementById("iframeL").style.display = "none";
    document.getElementById("clock").style.display = "none";
    document.getElementById("textm").style.display = "none";
  }
  sessionStorage.removeItem("buttonHidden");
};

$("#textm").on("click", function (e) {
  myFunction();
}).on("dblclick", function (e) {
  e.preventDefault();
});

setInterval(myTimer, 1000);

function myTimer() {
  const today = new Date();
  today.setHours(today.getHours()+7); 
  document.getElementById("clock").innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" + today.toISOString().substring(0,10) + "&nbsp;&#9788;&nbsp;" + today.toISOString().substring(11,19);
  var bd ="2025-09-05T23:59";
    var db ="2026-05-31T23:59";
  var ngaybd=new Date(bd);
  var ngaydb=new Date(db); 
  const now = new Date();
  var kta=now.getTime()-ngaybd.getTime();
  var ktb=now.getTime()-ngaydb.getTime();
  var ktc=(Math.abs(kta)+Math.abs(ktb)-Math.abs(kta-ktb));
  var ktd=(Math.abs(kta-ktb)-Math.abs(Math.abs(kta)-Math.abs(ktb)));
  var kte, kt;
  if(ktb-kta <0){kt=ktc;}
  if(ktb-kta>0) {kt=ktd;}
  if(db!="" && bd==""){kte=ktb;}
  if(db=="" && bd!=""){kte=-kta;}
  if(db==""&& bd==""){kte=0;}
  if(db!="" && bd!=""){kte=kt;}
  if(kte> 0 ) {
    document.getElementById("clock").style.display = "flex";
    document.getElementById("clock").innerHTML ="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+ bd +"◀▶" +db;
    document.getElementById("iframeL").style.display = "none";
    document.getElementById("textm").style.display = "none";
  }
}

function myFunction(){
  var m=document.getElementById("textm").value;
  var text;
  switch (m) {
    case "2501": text ="./web/FmkQ.html?url="+urlA; break;
    case "2505": text ="./web/FmkQ.html?url="+urlB; break;
    case "2512": text="./web/FmkQ.html?url="+urlC; break;
    case "2307": text="./web/FmkQ.html?url="+urlD; break;
    case "2310": text="./web/FmkQ.html?url="+urlE; break;
    
    default: text=""; break;
  }
  document.getElementById("iframeL").data = text;
  document.getElementById("iframeL").style.display = "flex";
  document.getElementById("textm").value = "";             
}

function Bfunction(){
  var m=document.getElementById("textm").value;
  var text;
  switch (m) {
    case "2501": text ="./web/formL.html?file=questionsCD.js&script="+urlA;break;
    case "2505": text = "./web/formL.html?file=questionsCD.js&script="+urlB; break;
    case "2512": text= "./web/formL.html?file=questions.js&script="+urlC; break;
    case "2307": text= "./web/boardBo.html"; break;
    case "2310": text= "./web/boardBo.html"; break;
    case "0808":text= "./web/formL.html?file=questionsCD.js&script="+urlF; break;
    case "0000":text= "./web/boardBo.html?file=list0.json"; break;
    default: text=""; break;
  }
  if(text!=""){
    document.getElementById("iframeL").data = text;
    document.getElementById("iframeL").style.display = "flex";
    document.getElementById("textm").style.display = "none";
  }
  document.getElementById("clock").style.display = "none";
  if(text==""){
    document.getElementById("textm").value = "";
    document.getElementById("iframeL").style.display = "flex";
  }
}

document.getElementById("textm").addEventListener("keypress", function(event) {
  if (event.key === "Enter") {
    event.preventDefault();
    document.getElementById("iframeL").setAttribute("style", "left:0;top:0;position: absolute;");
    Bfunction();
  }
});
</script>


    <script>
let startY = 0;
let tracking = false;
const SWIPE_THRESHOLD = 60;

// ---------- TOUCH ----------
document.addEventListener("touchstart", (e) => {
  if (e.touches.length !== 1) return;
  startY = e.touches[0].clientY;
  tracking = true;
}, { passive: true });

document.addEventListener("touchmove", (e) => {
  if (!tracking) return;
  const dy = startY - e.touches[0].clientY;
  if (Math.abs(dy) > 20) e.preventDefault(); // chặn scroll khi vuốt mạnh
}, { passive: false });

document.addEventListener("touchend", (e) => {
  if (!tracking) return;
  tracking = false;

  const endY = e.changedTouches[0].clientY;
  const diffY = startY - endY;

  if (Math.abs(diffY) > SWIPE_THRESHOLD) {
    toggleFullscreen();
  }
}, { passive: true });

// ---------- KEYBOARD ----------
document.addEventListener("keydown", (e) => {
  if (e.shiftKey && e.code === "Space") {
    e.preventDefault(); // tránh scroll
    toggleFullscreen();
  }
});

// ---------- FULLSCREEN CORE ----------
function toggleFullscreen() {
  if (document.fullscreenElement) {
    exitFullscreen();
  } else {
    enterFullscreen();
  }
}

function enterFullscreen() {
  const elem = document.documentElement;
  if (elem.requestFullscreen) elem.requestFullscreen();
  else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
  else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
}

function exitFullscreen() {
  if (document.exitFullscreen) document.exitFullscreen();
  else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
  else if (document.msExitFullscreen) document.msExitFullscreen();
}


// ===== FULLSCREEN BRIDGE (for <object> embedded docs) =====
window.addEventListener('message', function(ev){
  try{
    const d = ev.data;
    if(!d || typeof d !== 'object') return;
    if(d.type !== 'FS') return;
    if(d.action === 'enter') enterFullscreen();
    else if(d.action === 'exit') exitFullscreen();
    else if(d.action === 'toggle') toggleFullscreen();
  }catch(_){}
}, false);
</script>

</body>
</html>
